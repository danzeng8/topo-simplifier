<!DOCTYPE html>
<html>
<head>
  <title>To cut or to fill: A global optimization approach to topological simplification</title>
  <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  <link href='main.css' rel='stylesheet' type='text/css'>
</head>
<body>
 
  <!--<div id='masthead'>
    <img src='images/profile.png' class='profile'>

  </div> -->
   <header>
    <!--<a href='#' id='pageTitle'>TopoSimplifier</a>-->
   
    <nav>
       <h1 style="opacity: 1;">To cut or to fill: A global optimization approach to topological simplification</h1>
       <p><a class="authorNav" href="#">Dan Zeng</a>, <a class="authorNav" href="https://cs.slu.edu/~chambers/">Erin Chambers</a>, <a class="authorNav" href="https://cs.slu.edu/people/letscher/">David Letscher</a>, <a class="authorNav" href="https://www.cse.wustl.edu/~taoju/">Tao Ju</a></p>
      <br>
      <a href='#paper'>Paper</a>
      <a href="https://github.com/danzeng8/TopoSimplifier">Code</a>
      <a href='#examples'>Examples</a>
      <a href='#faq'>FAQ</a>
      <a href='#contact'>Contact</a>
    </nav>
  </header>
  <div id='all'>
    <section id='paper'>
        <div class ="row" style="background-color: rgba(192, 192, 255, 0.8); opacity: 1; margin: 140px 100px 0 100px; height: 40%; border-radius: 20px; float: center;">
          <div class="column" align="center">
            <p>This is the project website for our SIGGRAPH Asia 2020 paper
              <br><i>"To cut or to fill: a global optimization approach to topological simplification"</i>
            </p>
            <p>
              <b>Authors: </b>Dan Zeng(Author page coming soon), <a href="https://cs.slu.edu/~chambers/">Erin Chambers</a>, <a href="https://cs.slu.edu/people/letscher">David Letscher</a>, <a href="https://www.cse.wustl.edu/~taoju/">Tao Ju</a>
            </p>
            <p>
            ACM Transactions on Graphics (Proc. ACM Siggraph Asia 2020), 39(6): No. 201
            </p>
            <p> <b>Abstract:</b> We present a novel algorithm for simplifying the topology of a 3D shape, which is characterized by the number of connected components, handles, and cavities. Existing methods either limit their modifications to be only cutting or only filling, or take a heuristic approach to decide where to cut or fill. We consider the problem of finding a globally optimal set of cuts and fills that achieve the simplest topology while minimizing geometric changes. We show that the problem can be formulated as graph labelling, and we solve it by a transformation to the Node-Weighted Steiner Tree problem. When tested on examples with varying levels of topological complexity, the algorithm shows notable improvement over existing simplification methods in both topological simplicity and geometric distortions.</p>
            <a href="images\topological_simplification.pdf"><h3 style="text-align:center;">View/Download Paper</h3>
            <img src="images/page1.PNG" style="display:block; margin: auto; width: 30%;">
            </a>
          </div>

          <div class="column" >
            <div class="slideshow-container" style="display: block; margin: auto;">

              <div class="mySlides fade" >

                <img src="images/hipS.png" style="width:70%; margin: auto; display: block;">
                <div class="text">Given an input shape with topological features...</div>
              </div>

              <div class="mySlides fade">
                <img src="images/hipAllCutsAndFills.png" style="width:70%; margin: auto; display: block;">
                <div class="text">...we compute a set of cuts (red) and fills (blue) to simplify topology...</div>
              </div>

              <div class="mySlides fade">
                <img src="images/hipSelectedCutsAndFills.png" style="width:70%; margin: auto; display: block;">
                <div class="text">...select the subset which most simplifies topology while minimizing a geometric score...</div>
              </div>

               <div class="mySlides fade">
                <img src="images/hipResult.png" style="width:70%; margin: auto; display: block;">
                <div class="text">...to produce a simplified shape. </div>
              </div>


            </div>

            <div style="text-align:center">
              <div style="text-align:center">
                <span class="dotactive" onclick="currentSlide(1)"></span> 
                <span class="dotactive" onclick="currentSlide(2)"></span> 
                <span class="dotactive" onclick="currentSlide(3)"></span>
                <span class="dotactive" onclick="currentSlide(4)"></span> 
              </div>
            </div>
          </div>


          <script>
          var slideIndex = 0;
          showSlides();

          // Thumbnail image controls
function currentSlide(n) {
  slideIndex = n;
  var i;
  var slides = document.getElementsByClassName("mySlides");
  var dots = document.getElementsByClassName("dotactive");
  if (n > slides.length) {slideIndex = 1}
  if (n < 1) {slideIndex = slides.length}
  for (i = 0; i < slides.length; i++) {
      slides[i].style.display = "none";
  }
  for (i = 0; i < dots.length; i++) {
    dots[i].className = dots[i].className.replace(" active1 ", "");

  }
  slides[slideIndex-1].style.display = "block";  
  dots[slideIndex-1].className += " active1 ";
}

          function showSlides() {
            var i;
            var slides = document.getElementsByClassName("mySlides");
            var dots = document.getElementsByClassName("dotactive");
            for (i = 0; i < slides.length; i++) {
              slides[i].style.display = "none";  
            }
            slideIndex++;
            if (slideIndex > slides.length) {slideIndex = 1}    
            for (i = 0; i < dots.length; i++) {
              dots[i].className = dots[i].className.replace(" active1 ", "");

            }
            slides[slideIndex-1].style.display = "block";  
            dots[slideIndex-1].className += " active1 ";

            setTimeout(showSlides, 6000); // Change image every 2 seconds
          }
          </script>
        </div>
       
       

    </section>
     <br><br><br>
    <section id = 'examples' style="background-color: rgba(255, 192, 192, 0.8); opacity: 1; margin: 0px 100px 0 100px; border-radius: 20px; float: center;">
      <br>
      <h1>Examples</h1>
      <p style="text-align: left;">
        Provided here are the examples used in the figures of the paper, as well as a few others. We have applied our algorithm to simplify shapes coming from a variety of domains in both geometry modeling and biomedical and plant imaging. 
      </p>
      <a href="examples.zip" style="text-align: center;">
        <h3>Download All Examples (256 MB)</h3> 
      </a>

<p style="text-align: left;">
         In each example, we provide the topology of the input shape and simplified shape, and the command needed to reproduce the result (see <a href="https://github.com/danzeng8/TopoSimplifier">code</a>). Feel free to download the examples and follow along. 
         Our algorithm is flexible to the types of cuts and fills used for simplification: we demonstrate here distance-based, intensity-based, and morphological operation-based cuts and fills.
      </p>
      <h2>Using distance-based cuts and fills</h2>
      <p>If the goal is to simplify topology while minimizing the geometric change in terms of the volume occupied by the shape, then a distance field can be used to compute cuts and fills. We used the <a href="http://barbic.usc.edu/vega/">Vega-FEM </a> library to compute our signed distance fields (SDF). Our <a href="https://github.com/danzeng8/TopoSimplifier">github code documentation</a> provides instructions on how to convert a shape (surface mesh) to the volumetric SDF used as input to our code.</p>
      <button type="button" class="collapsible">Hip Bone (Click to Expand)</button>
      <div class="content">
        <img src="images/fig10.PNG" width='90%'>
        <p style="text-align: left;">Paper Fig. 10. (a): The Hip model with two handles (marked A and B). (b): Cut voxels (red) and fill voxels (blue) produced by topology-controlled inflation and deflation. (c): Selected fill voxels (filling in the small handle hole of A) and cut voxels (cutting open the narrow part of the handle body of B). (d): The modified shape. (e,f ): Results of TopoMender using a small parameter (e), which leaves the handle B in the shape, or using a large parameter (f ), which cuts open the wide handle body of A. (β: number of connected components, handles, and cavities; д: geometric cost)</p>
        <p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i> TopoSimplifier --in hip.tif --out hip_out.tif</p>
      </div>
      <button type="button" class="collapsible">Tree Model</button>
      <div class="content">
      <img src="images/fig11.PNG">
      <p style="text-align: left;">Paper Fig. 11. (a): The Tree shape with 18 handles. (b): Input cut (red) and fill (blue)
voxels. (c): Cut and fill voxels selected by our algorithm. (d): The modified
shape. (e): Cut and fill voxels selected by the greedy strategy, which include
a large group of fill voxels. (f ): Resulting shape of the greedy strategy. (β: number of connected components, handles, and cavities; д: geometric cost)</p>
<img src="images/fig12.PNG">
<p style="text-align: left;">
Fig. 12. Comparing result of our method (c) and MendIT (b) on a region
of the Tree with two handles (a). While MendIT fills a handle hole (A) and
makes a long cut (B) on the handle body, our method makes two short cuts
(C,D) without filling the handle hole.
</p>


<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i> TopoSimplifier --in examples/tree.tif --out tree_out.tif</p>
</div>
      <button type="button" class="collapsible">Human brain vessels (segmented from Angiography)</button>
      <div class="content">
      <img src="images/fig1.PNG" width='90%'>
      <p style="text-align: left;">Paper Fig. 1. To simplify the topology of a 3D shape (a), performing cutting alone (b) or filling alone (c) results in excessive changes, such as removing large
components (box C in (b)), creating long bridges to distant islands (box A in (c)) and large patches to fill in a handle (box B in (c)). Given a set of pre-computed
cuts and fills, our method optimally selects a subset of them to maximally simplify topology while minimizing the impact on the geometry (d). (β: number of
connected components, handles, and cavities; д: geometric cost)</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in vessels_distance.tif --out vessel_out.tif --K 0.115 --N -0.485</p>
</div>

<button type="button" class="collapsible">Human Heart (segmented from X-ray CT scan)</button>
<div class="content">
<img style="margin: auto; display: block;" src="./images/fig14.PNG" width='50%'>
<p style="text-align: left;">Paper Fig. 14. Comparing the result of our algorithm (b), the greedy labelling
strategy (c), and MendIT (d) on the Heart example. Both our method and
MendIT fully simplify the topology, while the greedy strategy leaves 4
handles in the shape. The inserts show a region where both the greedy
strategy and MendIT make excessive geometric changes. (β: number of
connected components, handles, and cavities; д: geometric cost)</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i> TopoSimplifier --in heart_distance.tif  --out heart_distance_out.tif</p>

</div>

      <button type="button" class="collapsible">Filigree</button>
       <div class="content">
      <div class="row">
        <div class="column" >
          <h4 style="margin: auto; display: block; text-align: center;">Input:</h4>
          <img style="margin: auto; display: block;" src="images/filigreeIn2.png" width='60%'>
          <h4 style="margin: auto; display: block; text-align: center;">Components: 1 Handles: 48 Cavities: 0</h4>
        </div>
       <div class="column" >
        <h4 style="margin: auto; display: block; text-align: center;">Output:</h4>
         <img style="margin: auto; display: block;" src="images/filigreeOut2.png" width='60%'>
         <h4 style="margin: auto; display: block; text-align: center;">Components: 1 Handles: 0 Cavities: 0 </h4>
       </div>
       
       
        <p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in filigree.tif --out filigree.tif </p>
     </div>
      </div>
<br>
<h2>Using intensity-based cuts and fills</h2>
<p>If the shape has some associated image data, for example if it was segmented from a biomedical / plant image volume, then the intensities of the image volume can be used to generate cuts and fills. When an underlying image volume is available, this will often be the preferred way to compute potential simplifications, rather than using distance-based cuts and fills.</p>
<button type="button" class="collapsible">Human brain vessels (segmented from Angiography)</button>
<div class="content">
<p>This is the same input shape as the human brain vessel in the distance-based example, but now the image intensity is used to generate the cuts and fills.</p>p>
<img src="images/fig15.PNG" width='50%'>

<p style="text-align: left;">Paper Fig. 15. The shape after subtracting intensity-aware cut voxels (a) or adding
intensity-aware fill voxels (b), and after running our algorithm with the
intensity-aware cuts and fills (c) or distance-based cuts and fills (d). The
inserts in (a,b) show the inner and outer seeds used for inflation and deflation.
The inserts in (c,d) examine a region where the same handle is
removed differently in the two results, either separating the two vessels (c)
or breaking a vessel in the middle (d). (β: number of
connected components, handles, and cavities; д: geometric cost)</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in vessels_intensity/ --out vessels_intensity_out/ --K 121 --S 58 --N 50 </p>
</div>

<button type="button" class="collapsible">Corn Root (segmented from X-ray Computed Tomography Scan): Highly Complex</button>
<div class="content">
<img src="images/fig17.PNG" width='90%'>

<p style="text-align: left;">Paper Fig. 17. (a): A highly complex iso-surface from a CT scan of a corn root. (b,c): Results of intensity-aware cutting and filling. (d): Our result. Box A highlights a
handle that is only removed by cutting (which separates the two root branches), and box B highlights islands that are only connected by filling. Our method
resolves both features. (β: number of
connected components, handles, and cavities; д: geometric cost)</p>
<img src="images/fig18.PNG" width='70%'>
<p style="text-align: left;">Fig. 18. Cut and fill voxels (a) and those selected by our algorithm (b) on
the Root. The inserts highlight a cluster of cut and fill voxels in a region
with complex topology.</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in root/ --out root_out/ --K 19 --S 15 --N 11 </p>
</div>

<button type="button" class="collapsible">Sorghum Panicle (segmented from X-ray Computed Tomography Scan): Highly Complex</button>
<div class="content">
<img src="images/fig16.PNG" width='90%'>

<p style="text-align: left;">Paper Fig. 16. (a): An iso-surface from a CT scan of a sorghum panicle. (b,c): Results of intensity-aware cutting and filling (cut/fill voxels shown on the left). (d): Our
result. Box A highlights a few islands that are only connected by filling, and box B highlights two handles that are only removed by cutting. Our method
resolves both features. (β: number of
connected components, handles, and cavities; д: geometric cost)</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in sorghum/  --out sorghumOut/ --K 95 --S 75 --N 55 </p>
</div>

<button type="button" class="collapsible">COVID-19 Protein (SARS-Cov-2 Spike Protein) from Cryo-EM imaging</button>
<div class="content">
<img src="images/covidResult.PNG" width='90%'>

<p style="text-align: left;">Our algorithm is able to cut the false self-intersection of the alpha-helix (A) and connects the beta strands (B), allowing for the tracing of the protein's backbone structure.</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in covid/ --out covid_out/ --K 174 --S 112 --N 92</p>
</div>
<br>
<h2>Using morphological operation-based cuts and fills</h2>
Morphological <i>opening</i> and <i>closing</i> are often used in image processing for noise removal. However, naive opening and closing may increase the number of topological features. In our work, we treat the cuts and fills created by opening and closing as potential topological changes to the shape, and only perform those which globally minimize the shape's topology. We apply this to the human heart example below.
<br>
<button type="button" class="collapsible">Human Heart (Segmented from X-ray CT Scan): Morphological Opening / Closing based cuts and fills</button>
<div class="content">
<img src="images/fig19.PNG" width='90%'>

<p style="text-align: left;">Paper Fig. 19. (a): A heart segmentation. (b): Result of opening (bottom), which contains several new islands (box A), and the corresponding cut voxels (top). (c):
Result of closing (bottom), which merges nearby vessels (box B) and thereby creating new handles, and the corresponding fill voxels (top). (d): Voxels selected
by our algorithm (top) and the modified shape (bottom). The insert examines a handle that is removed in all three methods.</p>
<p style="margin: auto; display: block; text-align: center;"><i>Command to reproduce this result:</i>TopoSimplifier --in heart_intensity/ --out heartOut/ --S 168 --close 3 --open 2</p>
</div>


      <script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.maxHeight){
      content.style.maxHeight = null;
    } else {
      content.style.maxHeight = content.scrollHeight + "px";
    } 
  });
}
</script>
    </section>
     
     <section id='faq' style="background-color: rgba(192, 192, 255, 0.8); opacity: 1; margin: 40px 100px 0 100px; border-radius: 20px; float: center;">
      <br>
      <h1>Frequently Asked Questions</h1>
      <p style="text-align: left;"><b>Q:</b>What is meant by <i>cutting</i> and <i>filling</i>?</p>
      <p style="text-align: left;"><b>A:</b>Cutting means to subtract voxels from the shape, while filling means to add voxels to it. Figure 2 of our paper shows how either cutting or filling can be used to remove a topological feature:</p>
      <img style="margin: auto; float: center; width: 25%;" src="https://github.com/danzeng8/topo-simplifier/blob/master/images/cutfill.PNG?raw=true">
      <br>
      <p style="text-align: left;"><b>Q:</b>Why do we choose a voxel-based representation?</p>
      <p style="text-align: left;"><b>A:</b>There is nothing inherent to our algorithm which limits it to only working on voxels. In fact, our algorithm can theoretically work on any cell decomposition (for example tetrahedral meshes, octree grids, sparse volumes). In such cell complexes, the top-dimensional cells would be assignedin our algorithm to be either kernel, cut, fill, or neighborhoods nodes. We chose to use a voxel-based representation in our implementation for two reasons: (1) voxels are one of the most commonly used ways to discretize space, particularly in biomedical and plant imaging as well as in surface reconstruction methods. (2) Existing methods for creating candidate cuts and fills are all implemented in voxels. We are strongly interested in extending our approach to create cuts and fills on non-cubical cell complexes, which may offer better scalability and preservation of surface details.</p>
      <br>
      <p style="text-align: left;"><b>Q:</b>How much topological simplification does the algorithm perform?</p>
      <p style="text-align: left;"><b>A:</b>By default, the provided implementation attempts to maximally simplify the topology to a shape with one connected component, no cavities, and no handles. This is done by simulating the kernel to be the single voxel with the highest value in the image volume, and the neighborhood to be a bounding box composed of the entire volume. As mentioned in the results section of our paper, this way to computing cuts and fills is the same as what previous works did. If desired, our implementation also provides a way to remove features which do not persist between two level sets (Kernel and Neighborhood). This may be a better setting to use in applications where some features want to be preserved, and other "noisy" ones want to be eliminated. The --K and --N parameters can be used to affect the level of simplification: the higher K is and the lower N is, the more simplification will be performed. This is because topological features which do no persist outside K and N will be removed. </p>
      <br>

      <p style="text-align: left;"><b>Q:</b>I only want to perform cutting, or only filling, to simplify the shape. How do I do this?</p>
      <p style="text-align: left;"><b>A:</b>To only perform cutting, set the input shape threshold equal to the neighborhood threshold, as follows:</p>
      <p style="text-align: center;">TopoSimplifier --in input.tif --out output.tif --N <i>X</i> --S <i>X</i> --K <i>G</i></p>
      <p style="text-align: left;">Where <i>G</i> is greater than <i>X</i>. Conversely, if you only want to perform filling, set the input shape threshold equal to the kernel threshold, as follows: </p>
      <p style="text-align: center;">TopoSimplifier --in input.tif --out output.tif --N <i>L</i> --S <i>X</i> --K <i>X</i></p>
      <p style="text-align: left;">Where <i>L</i> is lower than <i>X</i></p>

      <br>


     </section>
    <section id = 'contact' style="background-color: rgba(255, 192, 192, 0.8); opacity: 1; margin: 40px 100px 0 100px; border-radius: 20px; float: center;">
      <br>
      <h1>Contact Information</h1>
      <p>This page was developed and is maintained by Dan Zeng (Home page coming soon), a PhD Candidate with the Department of Computer Science and Engineering at Washington University in St. Louis.</p>
      <h3>Email: <a href='mailto:danzeng8@gmail.com'>danzeng8@gmail.com</a></h3>


    </section>
  </div>
  <div id='footer'>
    <b style="color: white;">Dan Zeng, <b>
    <a href='mailto:danzeng8@gmail.com'>danzeng8@gmail.com</a>
    <div style="margin:auto; float: right; " class="a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_email"></a>
    <a class="a2a_button_wechat"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_linkedin"></a>
    <a class="a2a_button_google_gmail"></a>
    <a class="a2a_button_douban"></a>
    <a class="a2a_button_whatsapp"></a>
    <a class="a2a_button_sina_weibo"></a>
    </div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->
  </div>
  <script src='js/main.js'></script>

</body>
</html>